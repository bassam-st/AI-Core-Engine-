<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ” Ø¨Ø­Ø« Ø§Ù„Ù†ÙˆØ§Ø© Ø§Ù„Ø°ÙƒÙŠØ©</title>
  <style>
    body{background:#0f1222;color:#e9ecff;font-family:"Cairo",system-ui,sans-serif;margin:0}
    header{background:#161a2d;padding:16px;text-align:center;box-shadow:0 3px 15px rgba(0,0,0,.3)}
    h1{margin:0;color:#10b981;font-size:22px}
    main{max-width:980px;margin:20px auto;padding:16px}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    input,select,button{padding:12px;border:none;border-radius:10px}
    input{flex:1;background:#1a1d32;color:#fff}
    select{background:#1a1d32;color:#fff}
    button{background:#10b981;color:#041016;font-weight:700}
    .card{background:#161a2d;border-radius:12px;padding:16px;margin-top:14px;box-shadow:0 3px 12px rgba(0,0,0,.3)}
    .muted{color:#93a0c9;font-size:13px}
    a{color:#7dd3fc;text-decoration:none}
    pre{white-space:pre-wrap;word-wrap:break-word}
  </style>
</head>
<body>

<header>
  <h1>ğŸ§  Ø¨Ø­Ø« Ø§Ù„Ù†ÙˆØ§Ø© Ø§Ù„Ø°ÙƒÙŠØ© (Google API)</h1>
  <p class="muted">ÙŠØ­Ù„Ù„ØŒ ÙŠÙ„Ø®Ù‘ØµØŒ ÙˆÙŠÙÙ‡Ù… Ø§Ù„Ù†ÙŠØ© ÙˆØ§Ù„Ù…Ø´Ø§Ø¹Ø±</p>
</header>

<main>
  <div class="row">
    <input id="q" placeholder="Ø§ÙƒØªØ¨ Ù…Ø§ ØªØ±ÙŠØ¯ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†Ù‡..." />
    <select id="style">
      <option value="friendly">ÙˆØ¯ÙˆØ¯</option>
      <option value="formal">Ø±Ø³Ù…ÙŠ</option>
      <option value="brief">Ù…Ø®ØªØµØ±</option>
    </select>
    <button onclick="go()">Ø¨Ø­Ø« Ø°ÙƒÙŠ</button>
  </div>

  <div id="meta" class="muted" style="margin-top:10px"></div>
  <div class="card" id="summary" style="display:none">
    <h3>ğŸ”¹ Ø§Ù„Ø®Ù„Ø§ØµØ© Ø§Ù„Ø°ÙƒÙŠØ©</h3>
    <pre id="answer"></pre>
  </div>
  <div id="cards"></div>
</main>

<script>
async function go(){
  const q=document.getElementById('q').value.trim();
  if(!q){alert('Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¨Ø­Ø«');return;}
  const style=document.getElementById('style').value;
  document.getElementById('meta').textContent='Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù„ÙŠÙ„...';
  document.getElementById('summary').style.display='none';
  document.getElementById('cards').innerHTML='';

  const res=await fetch('/api/smart_answer',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({query:q,style})
  });
  const data=await res.json();

  if(!data.ok){document.getElementById('meta').textContent='Ø®Ø·Ø£: '+(data.error||'');return;}

  document.getElementById('meta').innerHTML=
    `Ø§Ù„Ù†ÙŠØ©: <b>${data.intent}</b> â€” Ø§Ù„Ù…Ø´Ø§Ø¹Ø±: <b>${data.sentiment.label||data.sentiment}</b> â€” Ù…Ø­Ø±Ùƒ: <b>${data.engine}</b>`;

  document.getElementById('answer').textContent=data.answer||'';
  document.getElementById('summary').style.display='block';

  const box=document.getElementById('cards');
  (data.results||[]).forEach(r=>{
    const div=document.createElement('div');
    div.className='card';
    div.innerHTML=`<h3><a href="${r.link}" target="_blank">${r.title}</a></h3><p>${r.snippet}</p>`;
    box.appendChild(div);
  });
}
</script>
</body>
</html>
