<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Ù…Ø´ØºÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</title>
  <style>
    body{margin:0;background:#0b1220;color:#eaf1ff;font-family:system-ui,Segoe UI,Arial}
    header{padding:12px 16px;background:#101936;border-bottom:1px solid #1b2442}
    main{padding:12px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    input,button{padding:10px;border-radius:10px;border:1px solid #223053;background:#0f1730;color:#eaf1ff}
    button{background:#10b981;border:0;font-weight:700;color:#061416}
    .hint{font-size:13px;color:#9fb0d6}
    #player-wrap{max-width:900px;margin:12px auto}
    video{width:100%;max-height:75vh;background:#000;border-radius:12px}
  </style>
  <!-- HLS.js Ù„ØªØ´ØºÙŠÙ„ m3u8 Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body>
  <header>
    <div class="row">
      <strong>ğŸ¥ Ù…Ø´ØºÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</strong>
      <span class="hint">Ø§Ù„ØµÙ‚ Ø±Ø§Ø¨Ø· m3u8/MP4/MPD Ø£Ùˆ Ø§ÙØªØ­ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª.</span>
    </div>
  </header>

  <main>
    <div class="row">
      <input id="src" type="text" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø« Ù‡Ù†Ø§..." style="flex:1;">
      <button onclick="play()">ØªØ´ØºÙŠÙ„</button>
    </div>

    <div id="player-wrap">
      <video id="v" controls playsinline preload="auto"></video>
    </div>

    <p class="hint">Ù†ØµÙŠØ­Ø©: Ø¥Ù† Ù„Ù… ÙŠØ¹Ù…Ù„ Ø±Ø§Ø¨Ø· m3u8 Ø¹Ù„Ù‰ Ù…ØªØµÙØ­ÙƒØŒ Ø¬Ø±Ù‘Ø¨ MP4 Ø£Ùˆ Ø§ÙØªØ­ Ù…Ù† Ø¬Ù‡Ø§Ø² Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯ (Chrome).</p>
  </main>

  <script>
    function getParam(name){
      const url = new URL(window.location.href);
      return url.searchParams.get(name);
    }

    function isHls(u){ return /\.m3u8(\?|$)/i.test(u); }
    function isDash(u){ return /\.mpd(\?|$)/i.test(u); }

    async function play(){
      const url = document.getElementById('src').value.trim();
      if(!url){ alert('Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø« Ø£ÙˆÙ„Ù‹Ø§'); return; }
      const video = document.getElementById('v');

      // Ø£ÙˆÙ‚Ù Ø£ÙŠ ØªØ´ØºÙŠÙ„ Ø³Ø§Ø¨Ù‚
      if (window.hls) { try{ window.hls.destroy(); }catch(e){} }
      video.pause(); video.removeAttribute('src'); video.load();

      if(isHls(url) && window.Hls && Hls.isSupported()){
        window.hls = new Hls({lowLatencyMode:true});
        window.hls.loadSource(url);
        window.hls.attachMedia(video);
        window.hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
      }else{
        // Ù„Ù„Ù€ MP4 Ø£Ùˆ Ù…ØªØµÙØ­Ø§Øª ØªØ¯Ø¹Ù… HLS Ø£ØµÙ„Ø§Ù‹ (Safari/Android)
        video.src = url;
        video.play();
      }
    }

    // ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ø°Ø§ ÙˆØµÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
    const incoming = getParam('url');
    if(incoming){
      document.getElementById('src').value = incoming;
      play();
    }
  </script>
</body>
</html>
