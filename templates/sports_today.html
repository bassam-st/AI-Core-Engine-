<!-- templates/sports_today.html -->
<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…</title>
<style>
 body{font-family:system-ui,Segoe UI,Roboto,Arial;background:#0f172a;color:#e2e8f0;margin:0;padding:16px}
 .wrap{max-width:900px;margin:auto}
 .row{border:1px solid #223;border-radius:14px;padding:12px;margin:10px 0;background:#0b1220}
 .title{font-weight:700;font-size:16px}
 .sub{opacity:.85;font-size:13px}
 .btn{padding:8px 12px;border:0;border-radius:10px;background:#10b981;color:#041016;font-weight:700}
 .badge{display:inline-block;padding:4px 8px;border-radius:9999px;background:#1f2937;color:#e2e8f0;margin:2px}
 input,button{font-family:inherit}
 .ctrl{display:flex;gap:8px;align-items:center;margin-bottom:10px}
</style>
</head>
<body>
<div class="wrap">
  <h2>ğŸŸï¸ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…</h2>
  <div class="ctrl">
    <input id="league" placeholder="ÙÙ„ØªØ±Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="flex:1;padding:8px;border-radius:10px;border:1px solid #223;background:#0b1220;color:#e2e8f0"/>
    <label style="display:flex;gap:6px;align-items:center"><input type="checkbox" id="liveOnly"/> Ù„Ø§ÙŠÙ Ø§Ù„Ø¢Ù†</label>
    <button class="btn" onclick="load()">ØªØ­Ø¯ÙŠØ«</button>
  </div>
  <div id="sources"></div>
  <div id="list"></div>
</div>
<script>
let allMatches=[];
async function load(){
  const lg=document.getElementById('league').value||"";
  const url = lg ? `/api/sports/today?league=${encodeURIComponent(lg)}` : `/api/sports/today`;
  const r=await fetch(url);
  const data=await r.json();
  allMatches = data.matches||[];
  const srcDiv=document.getElementById('sources');
  srcDiv.innerHTML = "Ø§Ù„Ù…ØµØ§Ø¯Ø±: " + (data.sources||[]).map(s=>`<a class="badge" href="${s.url}" target="_blank">${s.name}</a>`).join(" ");
  render();
}
function render(){
  const liveOnly=document.getElementById('liveOnly').checked;
  const list=document.getElementById('list'); list.innerHTML="";
  const items = liveOnly ? allMatches.filter(isLive) : allMatches;
  if(!items.length){ list.innerHTML=`<div class="row">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ø¢Ù†.</div>`; return; }
  for(const m of items){
    const div=document.createElement('div'); div.className="row";
    const liveTag = isLive(m) ? " â€” Ù…Ø¨Ø§Ø´Ø± Ø§Ù„Ø¢Ù†" : "";
    div.innerHTML = `
      <div class="title">${m.home} Ã— ${m.away}</div>
      <div class="sub">${m.league||""} â€¢ ${m.time||""}${liveTag}</div>
      <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
        <a class="btn" href="/ui/sports_player?url=${encodeURIComponent('/api/xtream/play/22')}">ØªØ´ØºÙŠÙ„ Ù…Ø«Ø§Ù„</a>
        <a class="badge" href="${(m.source&&m.source.url)||'#'}" target="_blank">Ø§Ù„Ù…ØµØ¯Ø±</a>
      </div>
    `;
    list.appendChild(div);
  }
}
function isLive(m){
  const t=(m.time||"").toLowerCase();
  return ["live","Ù…Ø¨Ø§Ø´Ø±","Ø­ÙŠ","Ù‚ÙŠØ¯ Ø§Ù„Ù„Ø¹Ø¨","Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡"].some(x=>t.includes(x));
}
load();
document.getElementById('liveOnly').addEventListener('change', render);
</script>
</body>
</html>
